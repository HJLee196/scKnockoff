% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/BEMA.r
\name{SQM_Gamma}
\alias{SQM_Gamma}
\title{Estimate the number of spiked eigenvalues.}
\usage{
SQM_Gamma(data, alpha = 0.2, beta_q = 0.1, n_mc = 500, verbose = FALSE)
}
\arguments{
\item{data}{A numeric matrix of dimension n x p.}

\item{alpha}{A numeric scalar in (0, 0.5) specifying the trimming proportion
for the eigenvalue index set used in fitting.}

\item{beta_q}{A numeric scalar in (0, 0.5) specifying the tail probability
used to construct the empirical upper envelope of Monte Carlo null eigenvalues.}

\item{n_mc}{A positive integer specifying the number of Monte Carlo simulations.}

\item{verbose}{Logical scalar; if \code{TRUE}, print progress and timing
messages during computation.}
}
\value{
A list with components:
\describe{
\item{L_mat}{Monte Carlo eigenvalue matrix (n_mc x p), scaled by \code{1/n}.}
\item{l_true}{Eigenvalues of \code{t(data) \%*\% data / n}.}
\item{sigma2_est}{Estimated scaling factor (slope) used to match spectra.}
\item{theta_est}{Estimated Gamma shape parameter.}
\item{result_mat}{Matrix of estimated ranks evaluated at quantile
levels from 0.05 to 0.95.}
\item{alpha}{The input \code{alpha}.}
\item{beta_q}{The input \code{beta_q}.}
\item{estimated_rank}{Estimated rank at the quantile level \code{beta_q}.}
}
}
\description{
Estimate the number of spiked eigenvalues.
}
\examples{
set.seed(1)
n <- 50
r <- 5
p <- 30

X <- matrix(rnorm(n * r), n, r)
B <- matrix(rnorm(p * r), p, r)
err <- matrix(rnorm(n * p), n, p)

XBt <- X \%*\% t(B) + err

out <- SQM_Gamma(data = XBt, alpha = 0.2, beta_q = 0.1, n_mc = 30, verbose = TRUE)

}
\references{
This method is based on Algorithm 2 and GetQT1 in:

Ke, Z. T., Ma, Y., & Lin, X. (2023).
\emph{Estimation of the Number of Spiked Eigenvalues in a Covariance Matrix
by Bulk Eigenvalue Matching Analysis}.
Journal of the American Statistical Association, 118(541), 374--392.
\doi{10.1080/01621459.2021.1933497}

The implementation is adapted from the BEMA reference code
(\url{https://github.com/ZhengTracyKe/BEMA})
and is otherwise identical, with only minor implementation-level
modifications for computational efficiency.
}
